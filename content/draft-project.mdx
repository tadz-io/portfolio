---
title: "Advancing water quality monitoring from space"
publishedAt: "2025-05-21"
client: ""
services: "inverse modelling, model validation, image processing, Docker integration"
summary: "Optical satellite imagery is used to monitor water quality from space. On behalf of a client, I implemented a physics-based inversion model to derive indicators such as chlorophyll-a from ESA's Sentinel-2 satellite. The analysis focused on lakes and rivers in Germany and the United States. "
stack: [Python, Lmfit, Scikit-learn, Xarray, Pandas, Docker]
---

<figure class="float-left mr-4 my-4 mb-0 w-[300px]">
  <img
    src="/images/sentinel-2.jpg"
    alt="Sentinel-2 instrument"
    className="rounded-lg w-full h-auto"
  />
  <figcaption class="text-xs text-muted-foreground text-left mt-2">
    <b>Figure 1:</b> Sentinel-2 instrument (ESA)
  </figcaption>
</figure>

Monitoring harmful algal blooms is essential to protect public health and inform governmental agencies and private organizations about potential adverse effects on water quality. For several decades, satellite sensors have provided synoptic observations of water quality across the globe. Variations in algal concentration and composition cause subtle changes in the color of a water body’s surface, which these sensors detect. Retrieval algorithms interpret the satellite-measured reflectances and convert them into meaningful water-quality metrics.


Many retrieval models rely on empirical models trained on large, global datasets of *in-situ* (ground-truth) measurements. Although these global models yield remarkable insights into broad patterns of algal distribution in the oceans, their generality does not always extend to site-specific areas such as coastal and inland waters. In such environments, increased optical complexity (e.g., high turbidity, variable dissolved organic matter) hampers accurate water-quality retrieval from satellite observations.

<figure class="mt-0">
    <img src="/images/lake-pyramid.apng"></img>
  <figcaption class="text-xs text-muted-foreground text-left mt-0">
    <b>Figure 2:</b> Sentinel-2 captured the development of a phytoplankton bloom in Lake Pyramid, Nevada, during a 3 week period in October 2024. Imagery was acquired during 7 seperate overpassess of Sentinel-2. The normalized difference chlorophyll index (NDCI) was used to visualize the changing patterns in the distribution of chlorophyll-a over time.
  </figcaption>
</figure>

For one of my clients, I implemented the [HYDROPT model](https://github.com/tadz-io/hydropt) to improve water-quality retrieval for several lakes and rivers in Germany and the US. HYDROPT is a physics-based inversion model grounded in radiative transfer theory. It uses the full measured remote-sensing reflectance spectrum to simultaneously retrieve multiple water-quality parameters: chlorophyll-a concentration, suspended particulate matter, and dissolved organic matter absorption.


## Methodology

#### 1. Study sites and *in-situ* data
- Two matchup sites were selected that include a major river in the US and a lake in Germany.
- *in-situ* measurements were collected by local monitoring agencies and include chlorophyll-a, and turbidity measurements

#### 2. Satellite data acquistion and preprocessing
- Sentinel-2 Level-1B scenes covering match-up sites downloaded from data provider
- ACOLITE was applied to L1B data for atmospheric correction to derive the remote sensing reflectance

- Sentinel-2 MSI bands range from 10 m to 60 m spatial resolution; bands were resampled to common spatial resolution

#### 3. HYDROPT model configuration
- Model parameters were selected for Sentinel-2 bands in the visible domain (B1: 443, B2: 493 nm, B3: 560 nm, B4: 665 nm, B5: 705 nm)
- Selection of bio-optical models for phytoplankton, suspended matter and dissolved organic matter
- Packaged HYDROPT and all dependencies into a Docker container for reproducibility and cloud-based processing.


#### 4. Model run and validation

- HYDROPT was applied on a subset of matchups to select the most appropriate bio-optical parameter sets for each site.

- Processed the full image time series over the study periods.

- Extracted HYDROPT retrievals at each matchup date and compared them to the corresponding *in-situ* data.

- Computed performance metrics for chlorophyll-a, suspended matter and turbidity

## Results

- HYDROPT was fully containerized, enabling batch processing of Sentinel-2 scenes in a cloud‐based workflow 

- HYDROPT’s framework sets the stage for near-real-time monitoring, adaptive parameter tuning, and eventual integration of new sensors

## Conclusion:

HYDROPTS offers a flexible alternative to the off-the shelf band-ratio algorithms for the client. Hydropt can be tailored to environments such as turbid inland lakes. Incorporating site-specific *in-situ* bio-optical measurements (though not available during this project) can potentially further enhance water quality retrieval performance.
